@model RecipesVM
@{
    ViewData["Title"] = "Create Recipe";
}

<div class="container mx-auto px-4 py-8 max-w-3xl">
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-amber-900 mb-2">Create New Recipe</h1>
        <p class="text-amber-700">Add a delicious recipe to your collection</p>
    </div>

    <div class="bg-amber-50/95 backdrop-blur-sm px-8 py-8 shadow-xl rounded-lg border border-amber-300">
        <form asp-action="Create" method="post" class="space-y-6">
            @if (!ViewData.ModelState.IsValid && ViewData.ModelState.ErrorCount > 0)
            {
                <div asp-validation-summary="All" class="text-red-700 text-sm bg-red-100 border border-red-300 rounded-md p-3"></div>
            }

            <!-- Title Field -->
            <div>
                <label asp-for="Title" class="block text-sm font-medium text-amber-900 mb-2">Recipe Title</label>
                <input asp-for="Title" 
                       class="block w-full rounded-md border border-amber-400 bg-white/90 px-3 py-2 text-gray-900 placeholder:text-gray-500 focus:border-amber-700 focus:outline-none focus:ring-2 focus:ring-amber-700 focus:ring-offset-0 sm:text-sm"
                       placeholder="e.g., Grandma's Chocolate Chip Cookies">
                <span asp-validation-for="Title" class="text-red-700 text-xs mt-1 block"></span>
            </div>

            <!-- Instructions Field -->
            <div>
                <label asp-for="Instructions" class="block text-sm font-medium text-amber-900 mb-2">Instructions</label>
                <textarea asp-for="Instructions" 
                          rows="6" 
                          class="block w-full rounded-md border border-amber-400 bg-white/90 px-3 py-2 text-gray-900 placeholder:text-gray-500 focus:border-amber-700 focus:outline-none focus:ring-2 focus:ring-amber-700 focus:ring-offset-0 sm:text-sm"
                          placeholder="Describe the steps to prepare this recipe..."></textarea>
                <span asp-validation-for="Instructions" class="text-red-700 text-xs mt-1 block"></span>
            </div>

            <!-- Ingredients Section -->
            <div>
                <div class="flex items-center justify-between mb-3">
                    <h3 class="text-lg font-semibold text-amber-900">Ingredients</h3>
                    <button type="button" 
                            id="add-ingredient" 
                            class="px-4 py-2 bg-amber-700 text-white text-sm font-semibold rounded-md shadow-sm hover:bg-amber-800 focus:outline-none focus:ring-2 focus:ring-amber-700 focus:ring-offset-2 transition-colors">
                        + Add Ingredient
                    </button>
                </div>
                <p class="text-sm text-amber-700 mb-3">Enter each ingredient with quantity and unit (e.g., "1.5 cups flour", "2 eggs")</p>
                
                <div id="ingredient-list" class="space-y-3">
                    <!-- Dynamic ingredients will be added here -->
                </div>
            </div>

            <!-- Submit Button -->
            <div class="flex gap-3 pt-4">
                <button type="submit" 
                        class="flex-1 justify-center rounded-md bg-amber-700 px-6 py-3 text-sm font-semibold text-white shadow-sm hover:bg-amber-800 focus:outline-none focus:ring-2 focus:ring-amber-700 focus:ring-offset-2 transition-colors">
                    Save Recipe
                </button>
                <a asp-controller="Recipe" asp-action="Index" 
                   class="flex-1 text-center rounded-md bg-white border-2 border-amber-700 px-6 py-3 text-sm font-semibold text-amber-700 shadow-sm hover:bg-amber-50 focus:outline-none focus:ring-2 focus:ring-amber-700 focus:ring-offset-2 transition-colors">
                    Cancel
                </a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <script>
        let ingredientCount = 0;

        document.getElementById('add-ingredient').addEventListener('click', function() {
            ingredientCount++;
            var list = document.getElementById('ingredient-list');
            
            // Create ingredient wrapper
            var wrapper = document.createElement('div');
            wrapper.className = 'flex gap-2 items-start';
            wrapper.id = 'ingredient-wrapper-' + ingredientCount;
            
            // Create input
            var input = document.createElement('input');
            input.type = 'text';
            input.name = 'Ingredients';
            input.className = 'flex-1 rounded-md border border-amber-400 bg-white/90 px-3 py-2 text-gray-900 placeholder:text-gray-500 focus:border-amber-700 focus:outline-none focus:ring-2 focus:ring-amber-700 focus:ring-offset-0 sm:text-sm';
            input.placeholder = 'e.g., 1.5 cups flour';
            
            // Create remove button
            var removeBtn = document.createElement('button');
            removeBtn.type = 'button';
            removeBtn.className = 'px-3 py-2 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700 transition-colors';
            removeBtn.textContent = 'Remove';
            removeBtn.onclick = function() {
                wrapper.remove();
            };
            
            wrapper.appendChild(input);
            wrapper.appendChild(removeBtn);
            list.appendChild(wrapper);
            
            // Focus the new input
            input.focus();
        });

        // Add initial ingredient field on page load
        window.addEventListener('load', function() {
            document.getElementById('add-ingredient').click();
        });
    </script>
}